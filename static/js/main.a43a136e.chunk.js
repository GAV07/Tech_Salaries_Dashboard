(this.webpackJsonptech_salaries=this.webpackJsonptech_salaries||[]).push([[0],{102:function(e,t,a){e.exports=a(117)},108:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},113:function(e,t,a){},117:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(42),i=a.n(o),s=(a(107),a(108),a(7)),c=a.n(s),u=a(13),l=a(4),m=a(1),d=a(2),f=a.n(d),h=function(e){return{countyName:e.Name,USstate:e.State,medianIncome:Number(e["Median Household Income"]),lowerBound:Number(e["90% CI Lower Bound"]),upperBound:Number(e["90% CI Upper Bound"])}},b=m.q("%m/%d/%Y"),y=function(e){return!e["base salary"]||Number(e["base salary"])>3e5?null:{employer:e.employer,submit_date:b(e["submit date"]),start_date:b(e["start date"]),case_status:e["case status"],job_title:e["job title"],clean_job_title:e["job title"],base_salary:Number(e["base salary"]),city:e.city,USstate:e.state,county:e.county,countyID:e.countyID}},p=function(e){return{code:e.code,id:Number(e.id),name:e.name}},g=function(e){return{id:Number(e.id),name:e.name}},v=function(){var e=Object(u.a)(c.a.mark((function e(){var t,a,n,r,o,i,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([m.h("data/us.json"),m.a("data/us-county-names-normalized.csv",g),m.a("data/county-median-incomes.csv",h),m.a("data/h1bs-2012-2016.csv",y),m.r("data/us-state-names.tsv",p)]);case 2:return t=e.sent,a=Object(l.a)(t,5),n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],u={},o.filter((function(e){return f.a.find(r,{name:e.countyName})})).forEach((function(e){e.countyID=f.a.find(r,{name:e.countyName}).id,u[e.countyID]=e})),i=i.filter((function(e){return!f.a.isNull(e)})),e.abrupt("return",{usTopoJson:n,countyNames:r,medianIncomes:u,medianIncomesByCounty:f.a.groupBy(o,"countyName"),medianIncomesByUSState:f.a.groupBy(o,"USstate"),techSalaries:i,USstateNames:s});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=(a(111),a(112),a(43)),k=a.n(j),N=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k.a,{type:"bars",color:"#000000"}),r.a.createElement("h2",null,"Loading Dope Viz"))},E=a(3),O=a(44),S=function(e,t,a){return"function"===typeof e?e(t,a):e},w=function(e){var t=Object(E.a)({marginTop:40,marginRight:30,marginBottom:40,marginLeft:75},e);return Object(E.a)(Object(E.a)({},t),{},{boundedHeight:Math.max(t.height-t.marginTop-t.marginBottom,0),boundedWidth:Math.max(t.width-t.marginLeft-t.marginRight,0)})},A=function(e){var t=Object(n.useRef)(),a=w(e),r=Object(n.useState)(0),o=Object(l.a)(r,2),i=o[0],s=o[1],c=Object(n.useState)(0),u=Object(l.a)(c,2),m=u[0],d=u[1];Object(n.useEffect)((function(){if(a.width&&a.height)return[t,a];var e=t.current,n=new O.a((function(e){if(Array.isArray(e)&&e.length){var t=e[0];i!==t.contentRect.width&&s(t.contentRect.width),m!==t.contentRect.height&&d(t.contentRect.height)}}));return n.observe(e),function(){return n.unobserve(e)}}),[e,m,i,a]);var f=w(Object(E.a)(Object(E.a)({},a),{},{width:a.width||i,height:a.height||m}));return[t,f]},I=(a(113),Object(n.createContext)()),x=function(e){var t=e.dimensions,a=e.title,n=e.children;return r.a.createElement(I.Provider,{value:t},r.a.createElement("svg",{className:"Chart",width:t.width,height:t.height},r.a.createElement("text",{className:"Title",transform:"translate(".concat(t.boundedWidth/2,", 30)")},a),r.a.createElement("g",{transform:"translate(".concat(t.marginLeft,", ").concat(t.marginTop,")")},n)))},_=a(14),T=f.a.reverse(["rgb(247,251,255)","rgb(222,235,247)","rgb(198,219,239)","rgb(158,202,225)","rgb(107,174,214)","rgb(66,146,198)","rgb(33,113,181)","rgb(8,81,156)","rgb(8,48,107)"]),B=function(e){var t=e.geoPath,a=e.feature,n=(e.zoom,e.key,e.quantize),o=e.value,i="rgb(240,240,240)";return o&&(i=T[n(o)]),r.a.createElement("path",{d:t(a),style:{fill:i},title:a.id})},U=function(e){var t=e.usTopoJson,a=e.USstateNames,n=e.zoom,o=e.values,i=A(),s=Object(l.a)(i,2),c=s[0],u=s[1],d=m.e().scale(1280).translate([u.boundedWidth/2,u.boundedHeight/2]).scale(1.3*u.boundedWidth),h=m.f().projection(d),b=m.p().range(m.n(9));if(n&&t){var y=t,p=_.a(y,y.objects.states).features,g=f.a.find(a,{code:n}).id;d.scale(4.5*u.width);var v=h.centroid(f.a.find(p,{id:g})),j=d.translate();d.translate([j[0]-v[0]+u.boundedWidth/2,j[1]-v[1]+u.boundedHeight/2])}if(o&&b.domain([m.m(o,.15,(function(e){return e.value})),m.m(o,.85,(function(e){return e.value}))]),t){var k=t,N=_.b(k,k.objects.states,(function(e,t){return e!==t})),E=_.a(k,k.objects.counties).features,O=f.a.fromPairs(o.map((function(e){return[e.countyID,e.value]})));return r.a.createElement("div",{className:"Map",ref:c},r.a.createElement(x,{dimensions:u},E.map((function(e){return r.a.createElement(B,{geoPath:h,feature:e,zoom:n,key:e.id,quantize:b,value:O[e.id]})})),r.a.createElement("path",{d:h(N),style:{fill:"none",stroke:"#fff",strokeLinejoin:"round"}})))}return null},F=a(8),D=function(e){var t=e.data,a=e.keyAccessor,n=e.xAccessor,o=e.yAccessor,i=e.widthAccessor,s=e.heightAccessor,c=Object(F.a)(e,["data","keyAccessor","xAccessor","yAccessor","widthAccessor","heightAccessor"]);return r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return r.a.createElement("rect",Object.assign({},c,{className:"Bars__rect",key:a(e,t),x:S(n,e,t),y:S(o,e,t),width:m.j([S(i,e,t),0]),height:m.j([S(s,e,t),0])}))})))},M={x:function(e){var t=e.dimensions,a=e.label,n=e.formatTick,o=e.scale,i=Object(F.a)(e,["dimensions","label","formatTick","scale"]),s=t.boundedWidth<600?t.boundedWidth/100:t.boundedWidth/250,c=o.ticks(s);return r.a.createElement("g",Object.assign({className:"Axis AxisHorizontal",transform:"translate(0, ".concat(t.boundedHeight,")")},i),r.a.createElement("line",{className:"Axis__line",x2:t.boundedWidth}),c.map((function(e,t){return r.a.createElement("text",{key:e,className:"Axis__tick",transform:"translate(".concat(o(e),", 25)")},n(e))})),a&&r.a.createElement("text",{className:"Axis__label",transform:"translate(".concat(t.boundedWidth/2,", 60)")},a))},y:function(e){var t=e.dimensions,a=e.label,n=e.formatTick,o=e.scale,i=Object(F.a)(e,["dimensions","label","formatTick","scale"]),s=t.boundedHeight/70,c=o.ticks(s);return r.a.createElement("g",Object.assign({className:"Axis AxisVertical"},i),r.a.createElement("line",{className:"Axis__line",y2:t.boundedHeight}),c.map((function(e,t){return r.a.createElement("text",{key:e,className:"Axis__tick",transform:"translate(-16, ".concat(o(e),")")},n(e))})),a&&r.a.createElement("text",{className:"Axis__label",style:{transform:"translate(-56px, ".concat(t.boundedHeight/2,"px) rotate(-90deg)")}},a))}},H=function(e){var t=e.dimension,a=Object(F.a)(e,["dimension"]),o=Object(n.useContext)(I),i=M[t];return i?r.a.createElement(i,Object.assign({dimensions:o},a)):null};H.defaultProps={dimension:"x",scale:null,formatTick:m.d(",")};var C=H;var W=function(e){var t=e.data,a=e.value,n=e.width,o=e.height,i=e.x,s=e.y,c=e.bottomMargin,u=e.median,l=m.o().domain([0,m.j(t,a)]).range([o-s-c,0]),d=m.i()([[0,5],[n,5]]),f=u||m.l(t,a),h="translate(".concat(i,", ").concat(l(f),")"),b="Median Household: $".concat(l.tickFormat()(u));return r.a.createElement("g",{className:"mean",transform:h},r.a.createElement("text",{x:n-5,y:"0",textAnchor:"end",style:{background:"purple"}},b),r.a.createElement("path",{d:d}))},P=function(e){var t=e.data,a=e.xAccessor,n=e.medianHousehold,o=A({marginBottom:77}),i=Object(l.a)(o,2),s=i[0],c=i[1],u=m.o().domain(m.c(t,a)).range([0,c.boundedHeight]).nice(9),d=m.g().domain(u.domain()).value(a).thresholds(u.ticks(9))(t),f=function(e){return e.length},h=m.o().domain([0,m.j(d,f)]).range([0,c.boundedHeight]).nice();return r.a.createElement("div",{className:"Histogram",ref:s},r.a.createElement(x,{dimensions:c},r.a.createElement(C,{dimensions:c,dimension:"y",scale:u}),r.a.createElement(D,{data:d,keyAccessor:function(e,t){return t},yAccessor:function(e){return u(e.x0)+2},xAccessor:0,heightAccessor:function(e){return u(e.x1)-u(e.x0)-2},widthAccessor:function(e){return h(f(e))}}),r.a.createElement(W,{data:t,x:500,y:10,width:600,height:500,bottomMargin:5,median:n,value:function(e){return e.base_salary}})))},R=a(45),z=a(46),Y=a(49),J=a(48),L=a(47),V=a.n(L),$={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},K=function(e){var t=e.filteredSalaries,a=e.filteredBy;function n(){var e=a.year;return"*"===e?"":" in ".concat(e)}function o(){var e=a.USstate;return"*"===e?"":$[e.toUpperCase()]}function i(){var e=a.jobTitle,t=a.year,n="";return"*"===e?n="*"===t?"The average H1B in tech pays":"The average tech H1B paid":(n="Software ".concat(e,"s on an H1B"),n+="*"===t?" make":" made"),n}var s=m.o().domain(m.c(t,(function(e){return e.base_salary}))).tickFormat()(m.k(t,(function(e){return e.base_salary})));return n()&&o()?r.a.createElement("h2",{className:"Title"},"In ",o(),", ",i(),"$",s,"/year"," ",n()):r.a.createElement("h2",{className:"Title"},i()," $",s,"/year",o()?" in ".concat(o()):"",n())},G=function(e){Object(Y.a)(a,e);var t=Object(J.a)(a);function a(){return Object(R.a)(this,a),t.apply(this,arguments)}return Object(z.a)(a,[{key:"allDataForYear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.allData;return t.filter((function(t){return t.submit_date.getFullYear()===e}))}},{key:"allDataForJobTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.allData;return t.filter((function(t){return t.clean_job_title===e}))}},{key:"allDataForUSstate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.allData;return t.filter((function(t){return t.USstate===e}))}},{key:"render",value:function(){var e=this.format,t=m.k(this.props.data,(function(e){return e.base_salary})),a=m.b(this.props.data,(function(e){return e.base_salary}));return r.a.createElement("p",{className:"Description"},this.yearsFragment?this.yearsFragment:"Since 2012"," the"," ",this.UStateFragment," tech industry"," ",this.yearsFragment?"sponsored":"has sponsored"," ",r.a.createElement("b",null,e(this.props.data.length)," ",this.jobTitleFragment),this.previousYearFragment,". Most of them paid"," ",r.a.createElement("b",null,"$",e(t-a)," to $",e(t+a))," ","per year. ",this.countyFragment)}},{key:"yearsFragment",get:function(){var e=this.props.filteredBy.year;return"*"===e?"":"In ".concat(e)}},{key:"USstateFragment",get:function(){var e=this.props.filteredBy.USstate;return"*"===e?"":$[e.toUpperCase()]}},{key:"previousYearFragment",get:function(){var e,t=this.props.filteredBy.year;if("*"===t)e="";else if(2012===t)e="";else{var a=this.props.filteredBy,n=a.USstate,r=a.jobTitle,o=this.allDataForYear(t-1);if("*"!==r&&(o=this.allDataForJobTitle(r,o)),"*"!==n&&(o=this.allDataForUSstate(n,o)),this.props.data.length/o.length>2)e=", "+(this.props.data.length/o.length).toFixed()+" times more than the year before";else{var i=(100*(1-o.length/this.props.data.length)).toFixed();e=", "+Math.abs(i)+"% "+(i>0?"more":"less")+" than the year before"}}return e}},{key:"jobTitleFragment",get:function(){var e=this.props.filteredBy.jobTitle;return"*"===e||"other"===e?"H1B work visas":"H1B work visas for software ".concat(e,"s")}},{key:"countyFragment",get:function(){var e=this,t=f.a.groupBy(this.props.data,"countyID"),a=this.props.medianIncomesByCounty,n=f.a.sortBy(f.a.keys(t).map((function(e){return t[e]})).filter((function(t){return t.length/e.props.data.length>.01})),(function(e){return m.k(e,(function(e){return e.base_salary}))-a[e[0].countyID][0].medianIncome})),o=n[n.length-1],i=a[o[0].countyID][0].medianIncome,s=f.a.groupBy(o,"city");n=f.a.sortBy(f.a.keys(s).map((function(e){return s[e]})).filter((function(e){return e.length/o.length>.01})),(function(e){return m.k(e,(function(e){return e.base_salary}))-i})),o=n[n.length-1];var c=V()(o[0].city).titleCase().s+", ".concat(o[0].USstate),u=m.k(o,(function(e){return e.base_salary})),l=this.jobTitleFragment.replace("H1B work visas for","").replace("H1B work visas","");return r.a.createElement("span",null,"The best city"," ",l.length?"for ".concat(l," on an H1B"):"for an H1B"," ",this.yearFragment?"was":"is"," ",r.a.createElement("b",null,c)," with an average salary $",this.format(u-i)," above the local household median. Median household income is a good proxy for cost of living in an area."," ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Household_income"},"[1]"),".")}},{key:"format",get:function(){return m.o().domain(m.c(this.props.data,(function(e){return e.base_salary}))).tickFormat()}}]),a}(r.a.Component),q=function(e){var t=e.label,a=e.name,n=e.value,o=e.onClick,i="btn btn-default";return n&&(i+=" btn-primary"),r.a.createElement("button",{className:i,onClick:function(){return o(a,!n)}},t)},X=function(e){e.data;var t=e.toggleNames,a=e.picked,n=e.updateDataFilter,o=e.capitalize;function i(e,t){n(e,!t)}return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},t.map((function(e){return r.a.createElement(q,{label:o?e.toUpperCase():e,name:e,key:e,value:a===e,onClick:i})}))))},Z=function(e){var t=e.data,a=e.updateDataFilter,o=window.location.hash.replace("#","").split("-"),i=Object(n.useState)({year:o[0]||"*",USstate:o[1]||"*",jobTitle:o[2]||"*"}),s=Object(l.a)(i,2),c=s[0],u=s[1],m=Object(n.useState)({year:function(){return!0},USstate:function(){return!0},jobTitle:function(){return!0}}),d=Object(l.a)(m,2),f=d[0],h=d[1];var b=function(e,t){var a=function(t){return t.submit_date.getFullYear()===e};!t&&e||(a=function(){return!0},e="*"),u((function(t){return Object(E.a)(Object(E.a)({},t),{},{year:e})})),h((function(e){return Object(E.a)(Object(E.a)({},e),{},{year:a})}))},y=function(e,t){var a=function(t){return t.clean_job_title===e};!t&&e||(a=function(){return!0},e="*"),u((function(t){return Object(E.a)(Object(E.a)({},t),{},{jobTitle:e})})),h((function(e){return Object(E.a)(Object(E.a)({},e),{},{jobTitle:a})}))},p=function(e,t){var a=function(t){return t.USstate===e};!t&&e||(a=function(){return!0},e="*"),u((function(t){return Object(E.a)(Object(E.a)({},t),{},{USstate:e})})),h((function(e){return Object(E.a)(Object(E.a)({},e),{},{USstate:a})}))};Object(n.useEffect)((function(){var e=window.location.hash.replace("#","").split("-"),t=Object(l.a)(e,3),n=t[0],r=t[1],o=t[2];"*"!==n&&n&&b(Number(n)),"*"!==r&&r&&p(r),"*"!==o&&o&&y(o),window.location.hash=[c.year||"*",c.USstate||"*",c.jobTitle||"*"].join("-"),a((function(e){return f.year(e)&&f.USstate(e)&&f.jobTitle(e)}),c)}),[c,f]);var g=new Set(t.map((function(e){return e.submit_date.getFullYear()}))),v=new Set(t.map((function(e){return e.clean_job_title}))),j=new Set(t.map((function(e){return e.USstate})));return r.a.createElement("div",null,r.a.createElement(X,{data:t,toggleNames:Array.from(g.values()),picked:c.year,updateDataFilter:b}),r.a.createElement(X,{data:t,toggleNames:Array.from(v.values()),picked:c.jobTitle,updateDataFilter:y}),r.a.createElement(X,{data:t,toggleNames:Array.from(j.values()),picked:c.USstate,updateDataFilter:p,capitalize:"true"}))};var Q=function(){var e=Object(n.useState)({techSalaries:[],medianIncomes:[],countyNames:[],usTopoJson:null,USstateNames:null,medianIncomesByUSState:{},medianIncomesByCounty:{}}),t=Object(l.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)((function(){return function(){return!0}})),s=Object(l.a)(i,2),d=s[0],h=s[1],b=Object(n.useState)({USstate:"*",year:"*",jobTitle:"*"}),y=Object(l.a)(b,2),p=y[0],g=y[1],j=a.techSalaries,k=a.medianIncomes,E=a.countyNames,O=a.usTopoJson,S=a.USstateNames,w=a.medianIncomesByCounty,A=a.medianIncomesByUSState;function I(){return(I=Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:t=e.sent,o(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(n.useEffect)((function(){!function(){I.apply(this,arguments)}()}),[]);var x=j.filter(d),_=f.a.groupBy(x,"countyID"),T=E.map((function(e){return function(e,t,a){var n=a[e.id],r=t[e.name];if(!n||!r)return null;var o=m.l(r,(function(e){return e.base_salary}));return{countyID:e.id,value:o-n.medianIncome}}(e,_,k)})).filter((function(e){return!f.a.isNull(e)}));if(j.length<1)return r.a.createElement(N,null);var B=null,F=A.US[0].medianIncome;return"*"!==p.USstate&&(B=p.USstate,F=m.k(A[B],(function(e){return e.medianIncome}))),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Header"},r.a.createElement(K,{filteredSalaries:x,filteredBy:p}),r.a.createElement(G,{data:x,allData:j,filteredBy:p,medianIncomesByCounty:w})),r.a.createElement("div",{className:"Chart-area"},r.a.createElement(U,{usTopoJson:O,USstateNames:S,values:T,zoom:B}),r.a.createElement(P,{data:x,xAccessor:function(e){return e.base_salary},medianHousehold:F}),r.a.createElement(Z,{data:j,updateDataFilter:function(e,t){g(t),h((function(){return e}))}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[102,1,2]]]);
//# sourceMappingURL=main.a43a136e.chunk.js.map